"use strict";(()=>{var e={};e.id=490,e.ids=[490],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7296:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>U,patchFetch:()=>W,requestAsyncStorage:()=>S,routeModule:()=>A,serverHooks:()=>O,staticGenerationAsyncStorage:()=>E});var a={};r.r(a),r.d(a,{POST:()=>T});var s=r(9303),n=r(8716),i=r(670),o=r(7070),d=r(8091),c=r(1982),u=r(8116),p=r(4691);async function h(e,t,r){let a=await (0,p.f)(e,t,"sign");return(0,u.F)(e,a),new Uint8Array(await crypto.subtle.sign((0,c.O)(e,a.algorithm),a,r))}var l=r(7850),w=r(218),y=r(6572),f=r(9508),H=r(5424),g=r(3611);class m{#e;#t;#r;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#e=e}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setUnprotectedHeader(e){if(this.#r)throw TypeError("setUnprotectedHeader can only be called once");return this.#r=e,this}async sign(e,t){let r,a,s,n;if(!this.#t&&!this.#r)throw new w.GW("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,l.e)(this.#t,this.#r))throw new w.GW("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let i={...this.#t,...this.#r},o=(0,H.E)(w.GW,new Map([["b64",!0]]),t?.crit,this.#t,i),c=!0;if(o.has("b64")&&"boolean"!=typeof(c=this.#t.b64))throw new w.GW('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:u}=i;if("string"!=typeof u||!u)throw new w.GW('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,f.y)(u,e,"sign"),c?(r=(0,d.c)(this.#e),a=(0,y.cv)(r)):(a=this.#e,r=""),this.#t?(s=(0,d.c)(JSON.stringify(this.#t)),n=(0,y.cv)(s)):(s="",n=new Uint8Array);let p=(0,y.zo)(n,(0,y.cv)("."),a),m=await (0,g.k)(e,u),x=await h(u,m,p),b={signature:(0,d.c)(x),payload:r};return this.#r&&(b.header=this.#r),this.#t&&(b.protected=s),b}}class x{#a;constructor(e){this.#a=new m(e)}setProtectedHeader(e){return this.#a.setProtectedHeader(e),this}async sign(e,t){let r=await this.#a.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}var b=r(9099);class v{#t;#s;constructor(e={}){this.#s=new b.V$(e)}setIssuer(e){return this.#s.iss=e,this}setSubject(e){return this.#s.sub=e,this}setAudience(e){return this.#s.aud=e,this}setJti(e){return this.#s.jti=e,this}setNotBefore(e){return this.#s.nbf=e,this}setExpirationTime(e){return this.#s.exp=e,this}setIssuedAt(e){return this.#s.iat=e,this}setProtectedHeader(e){return this.#t=e,this}async sign(e,t){let r=new x(this.#s.data());if(r.setProtectedHeader(this.#t),Array.isArray(this.#t?.crit)&&this.#t.crit.includes("b64")&&!1===this.#t.b64)throw new w.uv("JWTs MUST NOT use unencoded payload");return r.sign(e,t)}}var j=r(1615);let P=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key-here-change-in-production");async function T(e){try{let{phoneNumber:t,otp:r}=await e.json();if(!t||!r)return o.NextResponse.json({error:"Phone number and OTP are required"},{status:400});if("1234"!==r)return o.NextResponse.json({error:"Invalid OTP"},{status:401});let a={name:"Nekshan Kumar",phoneNumber:t},s=await new v({user:a}).setProtectedHeader({alg:"HS256"}).setExpirationTime("7d").sign(P);return(await (0,j.cookies)()).set("auth-token",s,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),o.NextResponse.json({success:!0,user:a})}catch(e){return o.NextResponse.json({error:"Failed to verify OTP"},{status:500})}}let A=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/verify-otp/route",pathname:"/api/auth/verify-otp",filename:"route",bundlePath:"app/api/auth/verify-otp/route"},resolvedPagePath:"C:\\Users\\wealt\\OneDrive\\Desktop\\projects\\grow-wealth-hub-main\\grow-wealth-hub-main\\app\\api\\auth\\verify-otp\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:S,staticGenerationAsyncStorage:E,serverHooks:O}=A,U="/api/auth/verify-otp/route";function W(){return(0,i.patchFetch)({serverHooks:O,staticGenerationAsyncStorage:E})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[239,972,851],()=>r(7296));module.exports=a})();